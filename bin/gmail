#!/usr/bin/perl

use strict;
use warnings;
use local::lib;
use Data::Dumper;
use LifeGraphs;
use Net::IMAP::Simple::Gmail;
use Term::ReadPassword;

my $user = 'chicks.net@gmail.com';
my $pass;
my $tries = 5;

while ($tries--) {
	$pass = read_password("$user password: ");
	if ( defined $pass ) {
		print "ok, got password\n";
		last;
	} else {
		redo;
	}
}

my $server = 'imap.gmail.com';
my $imap = Net::IMAP::Simple::Gmail->new($server);
unless ( $imap->login( $user, $pass ) ) {
	warn "imap login failed: " . $imap->errstr . "\n";
	die "no login";
}

my $nm = $imap->select('INBOX');

#for(my $i = 1; $i <= $nm; $i++) {
#	# Get labels on message
#	my $labels = $imap->get_labels($msg);
#}
